TASK MANAGER:
	In Details tab, add these columns:
	• Image path name 
	• Command line

	Command lines for task manager in cmd.exe
		> tasklist
		> Get-Process
		> ps
		> wmic

SYSTEM
	The PID for System is always 4
	What is unusual behavior for this process?
	• A parent process (aside from System Idle Process (0))
	• Multiple instances of System. (Should only be 1 instance) 
	• A different PID. (Remember that the PID will always be PID 4)
	• Not running in Session 0

Smss.exe - Session Manager Subsystem
	Smss.exe starts csrss.exe (Windows subsystem) and wininit.exe in Session 0
	What is unusual?
	• A different parent process other than System(4)
	• Image path is different from C:\Windows\System32
	• More than 1 running process. (children self-terminate and exit after each new session)
	• User is not SYSTEM
	• Unexpected registry entries for Subsystem

csrss.exe - Client Server Runtime Process
	Called from smss.exe at startup for Session 1. Remember these processes are spawned by smss.exe which self-terminates itself.  
	What is unusual?
	• An actual parent process. (smss.exe calls this process and self-terminates)
	• Image file path other than C:\Windows\System32
	• Subtle misspellings to hide rogue process masquerading as csrss.exe in plain sight
	• User is not SYSTEM

wininit.exe - Windows Initialization Process
	Responsible for launching services.exe (Service Control Manager), lsass.exe (Local Security Authority), and lsaiso.exe within Session 0
	lsaiso.exe is a process associated with Credential Guard and Key Guard. You will only see this process if Credential Guard is enabled. 
	What is unusual?
	• An actual parent process. (smss.exe calls this process and self-terminates)
	• Image file path other than C:\Windows\System32
	• Subtle misspellings to hide rogue process in plain sight
	• Multiple running instances
	• Not running as SYSTEM

services.exe - Service Control Manager (SCM)
	Information regarding services is stored in the registry, HKLM\System\CurrentControlSet\Services. 
	This process is the parent to several other key processes: svchost.exe, spoolsv.exe, msmpeng.exe, dllhost.exe, to name a few.
	What is unusual?
	• A parent process other than wininit.exe
	• Image file path other than C:\Windows\System32
	• Subtle misspellings to hide rogue process in plain sight
	• Multiple running instances
	• Not running as SYSTEM

svchost.exe - Service Host (Host Process for Windows Services)
	They can name the malware svchost.exe or misspell it slightly, such as scvhost.exe. By doing so the intention is to go under the radar. Another tactic is to install/call a malicious service (DLL).  
	What single letter parameter should always be visible in the Command line or Binary path?
		-k
	What is unusual?
	• A parent process other than services.exe
	• Image file path other than C:\Windows\System32
	• Subtle misspellings to hide rogue process in plain sight
	• The absence of the -k parameter


LSASS - Local Security Authority Subsystem Servic
	Common tools such as mimikatz is used to dump credentials or they mimic this process to hide in plain sight. Again, they do this by either naming their malware by this process name or simply misspelling the malware slightly. 
	What is unusual?
	• A parent process other than wininit.exe
	• Image file path other than C:\Windows\System32
	• Subtle misspellings to hide rogue process in plain sight
	• Multiple running instances
	• Not running as SYSTEM

winlogon.exe
	• Remember from earlier sections, smss.exe launches this process along with a copy of csrss.exe within Session 1. 
	• It is also responsible for locking the screen and running the user's screensaver, among other functions.
	What is unusual?
		• An actual parent process. (smss.exe calls this process and self-terminates)
		• Image file path other than C:\Windows\System32
		• Subtle misspellings to hide rogue process in plain sight
		• Not running as SYSTEM
		• Shell value in the registry other than explorer.exe

Explorer.exe
	Winlogon process runs userinit.exe, which launches the value in HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell. Userinit.exe exits after spawning explorer.exe. 
	What is unusual?
	• An actual parent process. (userinit.exe calls this process and exits)
	• Image file path other than C:\Windows
	• Running as an unknown user
	• Subtle misspellings to hide rogue process in plain sight
	• Outbound TCP/IP connections



	









